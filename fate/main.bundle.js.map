{"version":3,"sources":["../fate/fate.js","./src/$_lazy_route_resource lazy","./src/app/app.component.css","./src/app/app.component.html","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/clickable/clickable.component.css","./src/app/clickable/clickable.component.html","./src/app/clickable/clickable.component.ts","./src/app/fate.service.ts","./src/assets/world.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":";;;;;AAAA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAM,UAAU;AAChB;;AAEA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM,SAAS;;AAEf;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,EAAE;;AAEF;;AAEA;AACA,iDAAiD,KAAK;AACtD;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,kBAAkB;;;;;;;;AC1QlB;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,4CAA4C,WAAW;AACvD;AACA;AACA,4E;;;;;;;ACVA,8BAA8B,yBAAyB,yBAAyB,kBAAkB,6BAA6B,8BAA8B,oCAAoC,kBAAkB,GAAG,sBAAsB,yBAAyB,yBAAyB,kBAAkB,iCAAiC,kCAAkC,mCAAmC,mCAAmC,4BAA4B,oBAAoB,iBAAiB,iBAAiB,8BAA8B,qCAAqC,WAAW,wBAAwB,6BAA6B,yBAAyB,mBAAmB,GAAG,eAAe,gCAAgC,sBAAsB,uBAAuB,8BAA8B,8BAA8B,8BAA8B,8BAA8B,GAAG,oBAAoB,sBAAsB,uBAAuB,GAAG,G;;;;;;;ACAx9B,yhB;;;;;;;;;;;;;;;;;;;;;ACAsG;AAEzD;AACL;AAOxC;IAYC,sBAAoB,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;QAVpC,YAAO,GAAU,EAAE,CAAC;QACpB,mBAAc,GAAU,EAAE,CAAC;QAG5B,eAAU,GAAe,EAAE,CAAC;IAMY,CAAC;IAEhD,+BAAQ,GAAR;QAAA,iBA4BC;QA3BA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,mBAAS;YAClE,EAAE,EAAC,CAAC,SAAS,CAAC;gBAAC,MAAM,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YACvB,EAAE,EAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACnB,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YAC7B,CAAC;YAED,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,WAAW,CAAC;YACjC,KAAI,CAAC,WAAW,GAAG,SAAS,CAAC,eAAe,CAAC,IAAI,CAAC;YAClD,EAAE,EAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACvB,EAAE,EAAC,KAAI,CAAC,QAAQ,KAAK,KAAI,CAAC,WAAW,CAAC,CAAC,CAAC;oBACvC,KAAI,CAAC,OAAO,GAAG,EAAE,CAAC;oBAClB,KAAI,CAAC,UAAU,GAAG,EAAE,CAAC;oBACrB,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;gBACzF,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACP,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,UAAO,SAAS,CAAC,kBAAkB,OAAG,CAAC,CAAC,CAAC;gBAChE,CAAC;gBAED,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,mBAAS;oBAChD,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC7D,CAAC,CAAC,CAAC;YACJ,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,UAAO,SAAS,CAAC,kBAAkB,OAAG,CAAC,CAAC,CAAC;YAChE,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,4DAAK,CAAC,CAAC;IAC9B,CAAC;IAED,kCAAW,GAAX;QACC,EAAE,EAAC,IAAI,CAAC,YAAY,CAAC;YAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IACvD,CAAC;IAED,yCAAkB,GAAlB;QACC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,GAAG,MAAM,CAAC;IAC/F,CAAC;IAEM,sCAAe,GAAtB,UAAuB,IAAI,EAAE,OAAsB;QAAtB,oCAAU,IAAI,CAAC,OAAO;QAClD,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;QAErC,EAAE,EAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACX,MAAM,CAAC,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC;QACxB,CAAC;QAED,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;IAEO,iCAAU,GAAlB,UAAmB,IAAI,EAAE,OAAsB;QAAtB,oCAAU,IAAI,CAAC,OAAO;QAC9C,EAAE,EAAC,CAAC,IAAI,CAAC;YAAC,MAAM,CAAC,EAAE,CAAC;QACpB,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QAEvC,OAAM,KAAK,EAAE,CAAC;YACb,OAAO,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;YAErD,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,OAAK,OAAO,CAAC,MAAM,GAAG,CAAC,OAAI,CAAC,CAAC;YAC3D,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QACpC,CAAC;QAED,MAAM,CAAC,IAAI,CAAC;IACb,CAAC;IAEO,kCAAW,GAAnB,UAAoB,SAAS;QAA7B,iBAEC;QADA,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAC,IAAI,YAAI,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,EAAE,KAAI,CAAC,cAAc,CAAC,EAA/C,CAA+C,CAAC,CAAC;IAC7G,CAAC;IApEkB;QAAlB,yEAAS,CAAC,MAAM,CAAC;kCAAa,iEAAU;oDAAC;IAV9B,YAAY;QALxB,wEAAS,CAAC;YACT,QAAQ,EAAE,UAAU;;;SAGrB,CAAC;yCAagC,kEAAW;OAZhC,YAAY,CA+ExB;IAAD,mBAAC;CAAA;AA/EwB;;;;;;;;;;;;;;;;;;;;;;ACViC;AACjB;AACI;AAEE;AACH;AACyB;AAiBrE;IAAA;IAAyB,CAAC;IAAb,SAAS;QAdrB,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,oEAAY;gBACZ,0FAAkB;aACnB;YACD,OAAO,EAAE;gBACP,gFAAa;gBACf,mEAAW;aACV;YACD,SAAS,EAAE;gBACX,kEAAW;aACX;YACA,SAAS,EAAE,CAAC,oEAAY,CAAC;SAC1B,CAAC;OACW,SAAS,CAAI;IAAD,gBAAC;CAAA;AAAJ;;;;;;;;ACvBtB,0BAA0B,iBAAiB,4BAA4B,4BAA4B,iCAAiC,wBAAwB,uBAAuB,GAAG,kBAAkB,4BAA4B,iBAAiB,GAAG,mBAAmB,4BAA4B,iBAAiB,GAAG,UAAU,iBAAiB,GAAG,sBAAsB,iBAAiB,oBAAoB,GAAG,eAAe,iBAAiB,sBAAsB,GAAG,G;;;;;;;ACAhd,yDAAyD,yCAAyC,2BAA2B,SAAS,iDAAiD,mBAAmB,2BAA2B,SAAS,Y;;;;;;;;;;;;;;;;;;;;ACA1K;AACtB;AAQ9C;IAaE,4BAAoB,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;QAZtC,aAAQ,GAAY,KAAK,CAAC;QAKxB,aAAQ,GAAY,KAAK,CAAC;IAOc,CAAC;IAEjD,qCAAQ,GAAR;QAAA,iBAcA;QAbA,EAAE,EAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;YAC3C,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACxB,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACvB,CAAC;QAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;QAEtD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QAEvD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,mBAAS;YAClE,KAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACvB,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,wCAAW,GAAX;QACC,EAAE,EAAC,IAAI,CAAC,YAAY,CAAC;YAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IACvD,CAAC;IAEM,oCAAO,GAAd;QACC,EAAE,EAAC,CAAC,IAAI,CAAC,SAAS,CAAC;YAAC,MAAM,CAAC;QAE3B,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC;QAC/B,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YAClB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAC,CAAC,CAAC;QACvE,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAC,CAAC,CAAC;QAClF,CAAC;IACF,CAAC;IAxCQ;QAAR,oEAAK,EAAE;;oDAAW;IAEV;QAAR,oEAAK,EAAE;;wDAA2B;IANvB,kBAAkB;QAL9B,wEAAS,CAAC;YACT,QAAQ,EAAE,eAAe;;;SAG1B,CAAC;yCAciC,kEAAW;OAbjC,kBAAkB,CA6C9B;IAAD,yBAAC;CAAA;AA7C8B;;;;;;;;;;;;;;;;;;;;;;;ACTY;AACL;AAEK;AAG3C;IAQE;QANO,cAAS,GAAiB,IAAI,6DAAO,EAAE,CAAC;QACxC,kBAAa,GAAa,EAAE,CAAC;QAC7B,kBAAa,GAAa,EAAE,CAAC;QAE9B,eAAU,GAAoB,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;IAEnD,CAAC;IAEV,0BAAI,GAAX,UAAY,WAAW;QACtB,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,gDAAS,CAAC,WAAW,CAAC,CAAC;QACvB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,iDAAU,EAAE,CAAC,CAAC;IACnC,CAAC;IAEM,6BAAO,GAAd;QACC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC7B,CAAC;IAEM,0BAAI,GAAX,UAAY,OAAO;QAClB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAChE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QAC3E,EAAE,EAAC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC1D,IAAI,MAAM,GAAG,gDAAS,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YAErD,MAAM,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;YAC/C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC5B,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;YACxB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QACzB,CAAC;IACF,CAAC;IAEM,qCAAe,GAAtB,UAAuB,OAAO;QAC7B,IAAI,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC/D,IAAI,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC/D,EAAE,EAAC,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;QAC5C,CAAC;QAED,EAAE,EAAC,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;QAC5C,CAAC;IACF,CAAC;IA5CW,WAAW;QADvB,yEAAU,EAAE;;OACA,WAAW,CA6CvB;IAAD,kBAAC;CAAA;AA7CuB;;;;;;;;;;ACNjB,IAAM,KAAK,GAClB,qjIAAymH,CAAC;;;;;;;;;ACD1mH;AAAA,mFAAmF;AACnF,8FAA8F;AAC9F,yEAAyE;AACzE,gFAAgF;AAEzE,IAAM,WAAW,GAAG;IACzB,UAAU,EAAE,KAAK;CAClB,CAAC;;;;;;;;;;;;;;ACP6C;AAC4B;AAE9B;AACY;AAEzD,EAAE,CAAC,CAAC,8EAAW,CAAC,UAAU,CAAC,CAAC,CAAC;IAC3B,8EAAc,EAAE,CAAC;AACnB,CAAC;AAED,yGAAsB,EAAE,CAAC,eAAe,CAAC,kEAAS,CAAC;KAChD,KAAK,CAAC,aAAG,IAAI,cAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAhB,CAAgB,CAAC,CAAC","file":"main.bundle.js","sourcesContent":["let util = require('util');\n\nlet pristineWorld;\nlet world;\nlet started = false;\n\nlet command;\nlet response = [];\n\nlet playerMoved = false;\nlet actionTaken = false;\nlet objectNames = [];\n\n// 'plus': 'add',\n// 'minus': 'subtract',\n// 'divided by': 'divide',\n// 'multiplied by': 'multiply',\n// 'remainder of division by': 'modulo'\n\nfunction resolveModifier(subject) {\n\tif(!subject.modifier) return resolveValue(subject);\n\n\tlet {operation} = subject.modifier;\n\tlet operand = resolveOperand(subject.modifier.operand);\n\n\tif(operation === 'add')\n\t\treturn {value: Number(resolveValue(subject)) + Number(operand)};\n\tif(operation === 'subtract')\n\t\treturn {value: Number(resolveValue(subject)) - Number(operand)};\n\tif(operation === 'divide')\n\t\treturn {value: Number(resolveValue(subject.value)) / Number(operand)};\n\tif(operation === 'multiply')\n\t\treturn {value: Number(resolveValue(subject)) * Number(operand)};\n\tif(operation === 'modulo')\n\t\treturn {value: Number(resolveValue(subject.value)) % Number(operand)};\n}\n\nfunction resolveValue(operand) {\n\tif(operand.variable) {\n\t\treturn resolveValue(world.variables[operand.variable]);\n\t}\n\n\tlet value = Number(operand.value);\n\tif(value || value === 0) {\n\t\treturn value;\n\t} else {\n\t\treturn operand.value;\n\t}\n}\n\nfunction resolveOperand(operand) {\n\tif(!operand.hasOwnProperty('value') && !operand.hasOwnProperty('variable')) return false;\n\n\tif(operand.value === '#here') return world.things['#player'].location;\n\tif(operand.value === '#command') return command;\n\n\tlet resolved = {\n\t\tvalue: resolveValue(operand)\n\t};\n\n\tif(operand.modifier) resolved.modifier = operand.modifier;\n\n\treturn resolveModifier(resolved);\n}\n\nfunction processIf(subject) {\n\tlet comparisons = [subject.if];\n\tlet results = [];\n\tif(subject.or) comparisons = comparisons.concat(subject.or);\n\n\tfor(let comparison of comparisons) {\n\t\tif(comparison.eq) {\n\t\t\tresults.push(resolveOperand(comparison.eq[0]) === resolveOperand(comparison.eq[1]));\n\t\t} else if(comparison.neq) {\n\t\t\tresults.push(resolveOperand(comparison.neq[0]) !== resolveOperand(comparison.neq[1]));\n\t\t} else if(comparison.in) {\n\t\t\tresults.push(world.things[resolveOperand(comparison.in[0])].location === resolveOperand(comparison.in[1]));\n\t\t} else if(comparison.nin) {\n\t\t\tresults.push(world.things[resolveOperand(comparison.nin[0])].location !== resolveOperand(comparison.nin[1]));\n\t\t}\n\t}\n\n\treturn results.some(x => x);\n}\n\nfunction processDo(subject) {\n\tsubject.forEach(x => {\n\t\tprocess(x);\n\t});\n}\n\nfunction processTravel(subject) {\n\tlet newLocation = resolveOperand(subject);\n\tworld.things['#player'].location = newLocation;\n\tplayerMoved = true;\n}\n\nfunction processSay(subject) {\n\tsubject.forEach(x => {\n\t\tlet value = resolveOperand(x);\n\t\tif(value) {\n\t\t\tresponse.push(value);\n\t\t\treturn;\n\t\t}\n\t\tprocess(x);\n\t});\n}\n\nfunction processMove(subject) {\n\tlet thing = resolveOperand(subject[0]);\n\tlet destination = resolveOperand(subject[1]);\n\n\tworld.things[thing].location = destination;\n}\n\nfunction processSet(subject) {\n\tworld.variables[resolveOperand(subject[0])] = resolveOperand(subject[1]);\n}\n\nfunction processList(subject) {\n\tlet location = resolveValue(subject.location);\n\tlet phrase = resolveValue(subject.phrase);\n\tlet things = Object.keys(world.things).filter(x => world.things[x].location === location);\n\n\tthings.forEach(thing => response.push(phrase.replace('#thing', world.things[thing].description)));\n}\n\nfunction processAction(subject) {\n\tlet actions = {\n\t\t\"travel\": processTravel,\n\t\t\"say\": processSay,\n\t\t\"move\": processMove,\n\t\t\"set\": processSet,\n\t\t\"list\": processList\n\t};\n\n\tfor(let action of Object.keys(actions)) {\n\t\tif(subject[action]) {\n\t\t\tactionTaken = true;\n\t\t\tactions[action](subject[action]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction process(subject) {\n\tif(subject.do)\n\t\tprocessDo(subject.do);\n\telse if(subject.if){\n\t\tif(processIf(subject)) {\n\t\t\tprocess(subject.then);\n\t\t} else if(subject.else) {\n\t\t\tprocess(subject.else);\n\t\t}\n\t} else {\n\t\tprocessAction(subject);\n\t}\n}\n\nfunction getThingsAtLocation(location) {\n\tlet thingsAtLocation = [];\n\n\tlet thingNames = Object.keys(world.things);\n\n\tfor(let thing of thingNames) {\n\t\tif(world.things[thing].location === location)\n\t\t\tthingsAtLocation.push(thing);\n\t}\n\n\treturn thingsAtLocation;\n}\n\nfunction checkPlayerMoved() {\n\tif(!playerMoved) return;\n\tplayerMoved = false;\n\tcommand = '#enter';\n\tresponse = [];\n\tprocess(world.places[world.things['#player'].location]);\n}\n\nfunction filterCommand(newCommand) {\n\tif(newCommand === '#enter') return newCommand;\n\tlet {keywords} = world.settings;\n\n\tlet words = [];\n\n\tkeywords.forEach(keyword => {\n\t\twords.push(keyword.keyword);\n\t\tif(keyword.synonyms) {\n\t\t\tkeyword.synonyms.forEach(synonym => {\n\t\t\t\tnewCommand = newCommand.replace(synonym, keyword.keyword);\n\t\t\t});\n\t\t}\n\t});\n\n\tlet matches = [];\n\n\twords.concat(objectNames).forEach(word => {\n\t\t let match = newCommand.match(new RegExp(`.*(${word}).*`));\n\t\t if(match) matches.push(match);\n\t});\n\n\treturn matches.map(x => x[1]).sort((a, b) => newCommand.indexOf(a) - newCommand.indexOf(b)).join(' ');\n}\n\nfunction load(worldString) {\n\tpristineWorld = worldString;\n\tworld = JSON.parse(worldString);\n\n\tobjectNames = objectNames.concat(Object.keys(world.things), Object.keys(world.places));\n}\n\nfunction move(newCommand) {\n\tif(!world || !started) return;\n\tcommand = newCommand;\n\t// if(world.settings.keywords) {\n\t// \tcommand = filterCommand(newCommand);\n\t// } else {\n\t// \tcommand = newCommand;\n\t// }\n\n\tlet anywhere\t\t\t\t= world['#anywhere'];\n\tlet currentPlace \t\t= world.places[world.things['#player'].location];\n\tlet localThings\t\t\t= getThingsAtLocation(world.things['#player'].location);\n\tlet playerThings\t\t= getThingsAtLocation('#player');\n\n\tprocess(currentPlace);\n\tlocalThings.forEach(x => {\n\t\tprocess(world.things[x]);\n\t});\n\n\tplayerThings.forEach(x => {\n\t\tprocess(world.things[x]);\n\t});\n\tprocess(anywhere);\n\n\tcheckPlayerMoved();\n\n\tlet compiledResponse = !actionTaken ? world.settings.onBadCommand : response.join(' ');\n\n\tresponse = [];\n\n\tif((!world.settings.registerTurn || world.settings.registerTurn === 'input') || actionTaken) {\n\t\tworld.variables['#turn'].value = ((+world.variables['#turn'].value) + 1) + ''\n\t}\n\n\tlet packet = {\n\t\tresponse: compiledResponse,\n\t\tworld,\n\t\tcurrentLocation: {\n\t\t\tname: world.things['#player'].location,\n\t\t\tdescription: resolveValue(world.places[world.things['#player'].location].description)\n\t\t},\n\t\tactionTaken\n\t};\n\tactionTaken = false;\n\treturn packet;\n}\n\nfunction start() {\n\tif(!world) return;\n\tstarted = true;\n\n\treturn move(`#enter`);\n}\n\nmodule.exports = { load, move, start }\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../fate/fate.js\n// module id = ../fate/fate.js\n// module chunks = main","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/$$_lazy_route_resource lazy\n// module id = ./src/$$_lazy_route_resource lazy recursive\n// module chunks = main","module.exports = \".container {\\n\\tdisplay: -webkit-box;\\n\\tdisplay: -ms-flexbox;\\n\\tdisplay: flex;\\n\\t-webkit-box-pack: center;\\n\\t    -ms-flex-pack: center;\\n\\t        justify-content: center;\\n\\theight: 100vh;\\n}\\n\\n.inner-container {\\n\\tdisplay: -webkit-box;\\n\\tdisplay: -ms-flexbox;\\n\\tdisplay: flex;\\n\\t-webkit-box-orient: vertical;\\n\\t-webkit-box-direction: normal;\\n\\t    -ms-flex-direction: column;\\n\\t        flex-direction: column;\\n\\tbackground-color: black;\\n\\n\\theight: 480px;\\n\\twidth: 380px;\\n\\tmargin: auto;\\n\\n\\tborder: 2px solid green;\\n\\n\\tpadding: 10px 10px 10px 10px\\n}\\n\\n.text {\\n\\t-webkit-box-flex: 1;\\n\\t    -ms-flex-positive: 1;\\n\\t        flex-grow: 1;\\n\\toverflow: auto;\\n}\\n\\n.commands {\\n\\tborder-top: 2px solid green;\\n\\tpadding-top: 10px;\\n\\ttext-align: center;\\n\\t-webkit-user-select: none;\\n\\t   -moz-user-select: none;\\n\\t    -ms-user-select: none;\\n\\t        user-select: none;\\n}\\n\\n.commands span {\\n\\tmargin-left: 10px;\\n\\tmargin-right: 10px;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.css\n// module id = ./src/app/app.component.css\n// module chunks = main","module.exports = \"<div class=\\\"container\\\">\\n\\t<div class=\\\"inner-container\\\">\\n\\t\\t<div class=\\\"text\\\" #text>\\n\\t\\t\\t<p *ngFor=\\\"let paragraph of paragraphs\\\">\\n\\t\\t\\t\\t<app-clickable \\t*ngFor=\\\"let word of paragraph\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t[data]=\\\"extractWordData(word)\\\">\\n\\t\\t\\t \\t</app-clickable>\\n\\t\\t\\t<p>\\n\\t\\t</div>\\n\\t\\t<div class=\\\"commands\\\">\\n\\t\\t\\t<app-clickable *ngFor=\\\"let keyword of keywords\\\" [isButton]=\\\"true\\\" [data]=\\\"extractWordData(keyword, keywordAliases)\\\"></app-clickable>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.html\n// module id = ./src/app/app.component.html\n// module chunks = main","import { Component, OnInit, OnDestroy, ViewChild, ElementRef, AfterViewChecked } from '@angular/core';\nimport { Subscription } from 'rxjs/Subscription';\nimport { FateService } from './fate.service';\nimport { world } from '../assets/world';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit, AfterViewChecked {\n\tprivate gameStateSub: Subscription;\n\tprivate aliases: any[] = [];\n\tprivate keywordAliases: any[] = [];\n\tpublic keywords: string[];\n\n\tpublic paragraphs: string[][] = [];\n\tpublic lastRoom: string;\n\tpublic currentRoom: string;\n\n\t@ViewChild('text') textWindow: ElementRef;\n\n\tconstructor(private fateService: FateService) {}\n\n\tngOnInit() {\n\t\tthis.gameStateSub = this.fateService.$gameState.subscribe(gameState => {\n\t\t\tif(!gameState) return;\n\t\t\tconsole.log(gameState);\n\t\t\tif(!this.keywords) {\n\t\t\t\tthis.getKeywords(gameState);\n\t\t\t}\n\n\t\t\tthis.lastRoom = this.currentRoom;\n\t\t\tthis.currentRoom = gameState.currentLocation.name;\n\t\t\tif(gameState.response) {\n\t\t\t\tif(this.lastRoom !== this.currentRoom) {\n\t\t\t\t\tthis.aliases = [];\n\t\t\t\t\tthis.paragraphs = [];\n\t\t\t\t\tthis.paragraphs.push(this.getAliases(gameState.currentLocation.description).split(' '));\n\t\t\t\t} else {\n\t\t\t\t\tthis.paragraphs.push([`>> \"${gameState.lastCommandDisplay}\"`]);\n\t\t\t\t}\n\n\t\t\t\tgameState.response.split('<p>').forEach(paragraph => {\n\t\t\t\t\tthis.paragraphs.push(this.getAliases(paragraph).split(' '));\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.paragraphs.push([`>> \"${gameState.lastCommandDisplay}\"`]);\n\t\t\t}\n\t\t});\n\n\t\tthis.fateService.load(world);\n\t}\n\n\tngOnDestroy() {\n\t\tif(this.gameStateSub) this.gameStateSub.unsubscribe();\n\t}\n\n\tngAfterViewChecked() {\n\t\tthis.textWindow.nativeElement.scrollTop = this.textWindow.nativeElement.offsetHeight + 100000;\n\t}\n\n\tpublic extractWordData(text, storage = this.aliases) {\n\t\tlet match = text.match(/{([0-9]+)}/);\n\n\t\tif(!match) {\n\t\t\treturn {content: text};\n\t\t}\n\n\t\treturn storage[+match[1]];\n\t}\n\n\tprivate getAliases(text, storage = this.aliases) {\n\t\tif(!text) return '';\n\t\tlet match = text.match(/{(.*)\\|(.*)}/);\n\n\t\twhile(match) {\n\t\t\tstorage.push({display: match[1], content: match[2]});\n\n\t\t\ttext = text.replace(match[0], `\\{${storage.length - 1}\\}`);\n\t\t\tmatch = text.match(/{(.*)\\|(.*)}/);\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tprivate getKeywords(gameState) {\n\t\tthis.keywords = gameState.world.settings.keywords.map(x => this.getAliases(x.keyword, this.keywordAliases));\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\n\nimport { AppComponent } from './app.component';\nimport { FateService} from './fate.service';\nimport { ClickableComponent } from './clickable/clickable.component';\n\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    ClickableComponent\n  ],\n  imports: [\n    BrowserModule,\n\t\tFormsModule\n  ],\n  providers: [\n\t\tFateService\n\t],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","module.exports = \"button {\\n\\tcolor: green;\\n\\tbackground-color: black;\\n\\tmargin: 5px 5px 5px 5px;\\n\\tpadding: 10px 10px 10px 10px;\\n\\tborder-color: green;\\n\\tborder-radius: 2px;\\n}\\n\\nbutton:hover {\\n\\tbackground-color: green;\\n\\tcolor: black;\\n}\\n\\nbutton:active {\\n\\tbackground-color: green;\\n\\tcolor: white;\\n}\\n\\nspan {\\n\\tcolor: green;\\n}\\n\\n.clickable:hover {\\n\\tcolor: white;\\n\\tcursor: pointer;\\n}\\n\\n.selected {\\n\\tcolor: white;\\n\\tfont-weight: bold;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/clickable/clickable.component.css\n// module id = ./src/app/clickable/clickable.component.css\n// module chunks = main","module.exports = \"<span *ngIf=\\\"!isButton\\\" [ngClass]=\\\"{selected: selected, clickable: clickable}\\\" (click)=\\\"clicked()\\\">{{display}}</span>\\n<button *ngIf=\\\"isButton\\\" [ngClass]=\\\"{selected: selected}\\\" (click)=\\\"clicked()\\\">{{display}}</button>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/clickable/clickable.component.html\n// module id = ./src/app/clickable/clickable.component.html\n// module chunks = main","import { Component, OnInit, OnDestroy, Input } from '@angular/core';\nimport { FateService } from '../fate.service';\nimport { Subscription } from 'rxjs/Subscription';\n\n@Component({\n  selector: 'app-clickable',\n  templateUrl: './clickable.component.html',\n  styleUrls: ['./clickable.component.css']\n})\nexport class ClickableComponent implements OnInit {\n\tpublic selected: boolean = false;\n\tpublic clickable: boolean;\n\n\t@Input() data: any;\n\n\t@Input() isButton: boolean = false;\n\n\tpublic display: string;\n\tpublic content: string;\n\n\tprivate gameStateSub: Subscription;\n\n  constructor(private fateService: FateService) { }\n\n  ngOnInit() {\n\t\tif(this.data.content.slice(0, 2) === '>>') {\n\t\t\tthis.clickable = false;\n\t\t} else {\n\t\t\tthis.clickable = true;\n\t\t}\n\n\t\tthis.display = this.data.display || this.data.content;\n\n\t\tthis.content = this.data.content.replace(/[.,:]/g, '');\n\n\t\tthis.gameStateSub = this.fateService.$gameState.subscribe(gameState => {\n\t\t\tthis.selected = false;\n\t\t});\n\t}\n\n\tngOnDestroy() {\n\t\tif(this.gameStateSub) this.gameStateSub.unsubscribe();\n\t}\n\n\tpublic clicked() {\n\t\tif(!this.clickable) return;\n\t\t\n\t\tthis.selected = !this.selected;\n\t\tif(this.selected) {\n\t\t\tthis.fateService.move({display: this.display, content: this.content});\n\t\t} else {\n\t\t\tthis.fateService.clearFromBuffer({display: this.display, content: this.content});\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/clickable/clickable.component.ts","import { Injectable } from '@angular/core';\nimport { Subject} from 'rxjs/Subject';\nimport { Observable } from 'rxjs/Observable';\nimport * as fate from '../../../fate/fate';\n\n@Injectable()\nexport class FateService {\n\tprivate worldString: string;\n\tprivate gameState: Subject<any> = new Subject();\n\tprivate commandBuffer: string[] = [];\n\tprivate displayBuffer: string[] = [];\n\n\tpublic $gameState: Observable<any> = this.gameState.asObservable();\n\n  constructor() {}\n\n\tpublic load(worldString) {\n\t\tthis.worldString = worldString;\n\t\tfate.load(worldString);\n\t\tthis.gameState.next(fate.start());\n\t}\n\n\tpublic restart() {\n\t\tthis.load(this.worldString);\n\t}\n\n\tpublic move(command) {\n\t\tthis.displayBuffer = this.displayBuffer.concat(command.display);\n\t\tthis.commandBuffer = this.commandBuffer.concat(command.content.split(' '));\n\t\tif(this.commandBuffer.length > 1) {\n\t\t\tlet lastCommandDisplay = this.displayBuffer.join(' ... ');\n\t\t\tlet result = fate.move(this.commandBuffer.join(' '));\n\n\t\t\tresult.lastCommandDisplay = lastCommandDisplay;\n\t\t\tthis.gameState.next(result);\n\t\t\tthis.commandBuffer = [];\n\t\t\tthis.displayBuffer = [];\n\t\t}\n\t}\n\n\tpublic clearFromBuffer(command) {\n\t\tlet displayIndex = this.displayBuffer.indexOf(command.display);\n\t\tlet commandIndex = this.commandBuffer.indexOf(command.content);\n\t\tif(commandIndex > -1) {\n\t\t\tthis.commandBuffer.splice(commandIndex, 1);\n\t\t}\n\n\t\tif(displayIndex > -1) {\n\t\t\tthis.displayBuffer.splice(displayIndex, 1);\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/fate.service.ts","export const world: string =\n`{\"#anywhere\":{\"do\":[{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"check inventory\"}]},\"then\":{\"list\":{\"location\":{\"value\":\"#player\"},\"phrase\":{\"value\":\"You have #thing.\"}}}},{\"if\":{\"eq\":[{\"variable\":\"_street_escaped\"},{\"value\":\"false\"}]},\"then\":{\"do\":[{\"if\":{\"eq\":[{\"variable\":\"_street_num_turns\"},{\"value\":\"3\"}]},\"then\":{\"say\":[{\"value\":\"<p>The wind is beginning to howl.<p>\"}]}},{\"if\":{\"eq\":[{\"variable\":\"_street_num_turns\"},{\"value\":\"6\"}]},\"then\":{\"say\":[{\"value\":\"<p>You sense It drawing near.<p>\"}]}},{\"if\":{\"eq\":[{\"variable\":\"_street_num_turns\"},{\"value\":\"9\"}]},\"then\":{\"say\":[{\"value\":\"<p>\\\\\\\"God save me... It's here...\\\\\\\"<p>\"}]}},{\"if\":{\"eq\":[{\"variable\":\"_street_num_turns\"},{\"value\":\"10\"}]},\"then\":{\"travel\":{\"value\":\"_street_death\"}}}]}}]},\"places\":{\"_intro\":{\"description\":\"\",\"do\":[{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"#enter\"}]},\"then\":{\"do\":[{\"say\":[{\"value\":\"A shadow hunts you. What had been but a vague and lurking fear, a scratching at the outer wall of the conscious mind,\"}]},{\"say\":[{\"value\":\"become a sudden reality after that terrible ritual. It had been folly to participate, you knew that now. And perhaps it had\"}]},{\"say\":[{\"value\":\"even been a trap set by Willem to destroy you, or to feed the thing? You could only guess, and there was no time now for guessing.<p>\"}]},{\"say\":[{\"value\":\"Only flight.<p>\"}]},{\"say\":[{\"value\":\"{Continue...|_intro_next 1}\"}]}]}},{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"_intro_next 1\"}]},\"then\":{\"do\":[{\"say\":[{\"value\":\"The Thing is only a step behind, but somehow you've made it this far. Dusk has fallen and you stand in the very street where\"}]},{\"say\":[{\"value\":\"Dr. Walter Sinclar lives; an expert in the occult and the only hope you have of freedom from your eldrich pursuer.\"}]},{\"say\":[{\"value\":\"Still clutching his letter in your hand, you stare wildly about you for the proper house.<p>\"}]},{\"say\":[{\"value\":\"{Continue...|_intro_next 2}\"}]}]}},{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"_intro_next 2\"}]},\"then\":{\"travel\":{\"value\":\"_street\"}}}]},\"_street\":{\"description\":{\"value\":\"{A Darkened Street|_street}\"},\"do\":[{\"set\":[{\"value\":\"_street_num_turns\"},{\"modifier\":{\"operation\":\"add\",\"operand\":{\"value\":\"1\"}},\"variable\":\"_street_num_turns\"}]},{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"look around\"}]},\"or\":[{\"eq\":[{\"value\":\"#command\"},{\"value\":\"#enter\"}]}],\"then\":{\"say\":[{\"value\":\"Great and imposing houses stand back from the pavement to the right and left of the empty street.\"}]}}]},\"_street_death\":{\"description\":{\"value\":\"You have died...\"},\"do\":[{\"say\":[{\"value\":\"<p>Too long in the open, and without Dr. Sinclar's aid, the horrible shadow has consumed you.<p>\"}]},{\"say\":[{\"value\":\"(Refresh the page to play again)\"}]}]}},\"things\":{\"#player\":{\"location\":\"_intro\"},\"_sinclar_letter\":{\"location\":\"#player\",\"description\":\"{a letter from Dr. Walter Sinclar|_sinclar_letter}\",\"do\":[{\"if\":{\"eq\":[{\"value\":\"#command\"},{\"value\":\"examine _sinclar_letter\"}]},\"then\":{\"if\":{\"in\":[{\"value\":\"_sinclar_letter\"},{\"value\":\"#player\"}]},\"then\":{\"do\":[{\"say\":[{\"value\":\"\\\\\\\"Dear Mr. Smith<p>\"}]},{\"say\":[{\"value\":\"I have learned of your plight. Make no mistake, you are in grave danger.\"}]},{\"say\":[{\"value\":\"However, I believe I can help you. Come to my home on Mayfair Street at once, number 385.<p>\"}]},{\"say\":[{\"value\":\"Do not delay.\\\\\\\"\"}]}]}}}]}},\"variables\":{\"_street_num_turns\":{\"value\":\"0\"},\"_street_escaped\":{\"value\":\"false\"},\"#turn\":{\"value\":\"1\"}},\"settings\":{\"keywords\":[{\"keyword\":\"use\"},{\"keyword\":\"examine\"},{\"keyword\":\"look around\"},{\"keyword\":\"{inventory|check inventory}\"},{\"keyword\":\"{north|go north}\"},{\"keyword\":\"{south|go south}\"},{\"keyword\":\"{east|go east}\"},{\"keyword\":\"{west|go west}\"}]}}`;\n\n\n\n// WEBPACK FOOTER //\n// ./src/assets/world.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/environments/environment.ts","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.log(err));\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts"],"sourceRoot":"webpack:///"}